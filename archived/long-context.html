<!DOCTYPE html>
<html lang="ko" data-theme="dark-kernel">
<head>
<script>
(function(){var m=document.cookie.match(/claude_theme=([^;]+)/);if(m)document.documentElement.setAttribute('data-theme',m[1]);})();
</script>
<meta charset="UTF-8">
<meta property="og:type" content="article">
<meta property="og:site_name" content="Claude 문서 /with MINZKN">
<meta property="og:title" content="긴 컨텍스트 - Claude 문서">
<meta property="og:description" content="200K+ 토큰 컨텍스트 윈도우 활용법, 대규모 문서 처리 전략">
<meta property="og:url" content="https://minzkn.com/claude/pages/long-context.html">
<meta property="og:image" content="https://minzkn.com/claude/images/og-image.png">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="200K+ 토큰 컨텍스트 윈도우 활용법, 대규모 문서 처리 전략">
<meta name="keywords" content="긴 컨텍스트, long context, 200K tokens, 대규모 문서, context window">
<meta name="author" content="MINZKN">
<title>긴 컨텍스트 - Claude 문서 /with MINZKN</title>
<link rel="icon" type="image/svg+xml" href="../images/favicon.svg">
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/joungkyun/font-d2coding/d2coding.css">
<link rel="stylesheet" href="../css/themes.css">
<link rel="stylesheet" href="../css/style.css">
<link rel="stylesheet" href="../css/responsive.css">
</head>
<body>
<div class="page-wrapper">

<header class="site-header"></header>
<nav class="side-nav" aria-label="사이트 내비게이션"></nav>

<main class="main-content">

<nav class="breadcrumb"></nav>

<section class="content-section">
  <h1 id="top">긴 컨텍스트 (Long Context)</h1>
  <p class="lead">
    Claude는 최대 <strong>200,000 토큰</strong> 이상의 컨텍스트 윈도우를 지원하여
    대규모 문서, 긴 대화, 대형 코드베이스를 한 번에 처리할 수 있습니다.
  </p>
</section>

<section class="content-section">
  <h2 id="quick-start">처음 시작하기</h2>

  <div class="info-box tip">
    <div class="info-box-title">🎓 처음 긴 컨텍스트를 사용하시나요?</div>
    <p><strong>핵심 개념:</strong></p>
    <p>
      200K 토큰 = <strong>소설 약 3-4권 분량</strong> = <strong>600-700 페이지 문서</strong> = <strong>코드 파일 500개</strong>
    </p>
    <p style="margin-top: 1em;"><strong>3가지 활용법:</strong></p>
    <ol>
      <li><strong>대규모 문서 통째로</strong> - PDF, 계약서, 기술 문서를 전체 입력</li>
      <li><strong>코드베이스 전체</strong> - 여러 파일을 한 번에 분석</li>
      <li><strong>긴 대화 유지</strong> - 수백 턴의 대화 이력 보존</li>
    </ol>
    <p style="margin-top: 1em;">
      💡 <strong>비용 절감 팁</strong>: 같은 문서를 여러 번 사용한다면 <code>cache_control</code>로 프롬프트 캐싱 (90% 할인!)
    </p>
  </div>
</section>

<section class="content-section">
  <h2 id="overview">개요</h2>
  <p>
    컨텍스트 윈도우는 AI가 한 번에 "기억"할 수 있는 정보의 양을 의미합니다.
    Claude의 긴 컨텍스트는 다음과 같은 규모를 처리할 수 있습니다:
  </p>

  <table>
    <thead>
      <tr>
        <th>토큰 수</th>
        <th>대략적인 분량</th>
        <th>실제 예시</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>200,000</td>
        <td>약 50만 단어</td>
        <td>소설 75권, 코드베이스 500개 파일</td>
      </tr>
      <tr>
        <td>100,000</td>
        <td>약 25만 단어</td>
        <td>긴 기술 문서, 학술 논문 50편</td>
      </tr>
      <tr>
        <td>50,000</td>
        <td>약 12만 단어</td>
        <td>책 1~2권, 대형 프로젝트 문서</td>
      </tr>
    </tbody>
  </table>

  <div class="info-box info">
    <div class="info-box-title">💡 토큰 vs 단어</div>
    <p>
      토큰은 AI가 처리하는 텍스트의 기본 단위입니다. 영어는 평균 1 토큰 ≈ 0.75 단어이며,
      한국어는 1 토큰 ≈ 2~4글자 정도입니다. 정확한 토큰 수는 Anthropic의 토큰 카운터나
      SDK의 <code>count_tokens()</code> 메서드로 확인할 수 있습니다.
    </p>
  </div>

  <figure style="margin: 2.5rem 0;">
    <svg viewBox="0 0 800 300" style="width: 100%; max-width: 800px; height: auto; display: block; margin: 0 auto;">
      <defs>
        <marker id="longctx-1-arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
          <path d="M0,0 L8,3 L0,6 Z" fill="var(--diagram-arrow)"/>
        </marker>
      </defs>

      <!-- 200K 토큰 윈도우 (큰 박스) -->
      <rect x="50" y="30" width="700" height="80" fill="none" stroke="var(--diagram-border)" stroke-width="2"/>
      <text x="400" y="20" text-anchor="middle" font-size="14" font-weight="bold" fill="var(--diagram-text)">200,000 토큰 컨텍스트 윈도우</text>
      <text x="60" y="55" font-size="12" fill="var(--diagram-text)">소설 75권 / 코드베이스 500개 파일</text>
      <text x="60" y="75" font-size="12" fill="var(--diagram-text)">약 50만 단어</text>
      <text x="60" y="95" font-size="11" fill="var(--diagram-secondary)">전체 컨텍스트를 동시에 "기억"</text>

      <!-- 100K 토큰 윈도우 (중간 박스) -->
      <rect x="50" y="130" width="500" height="60" fill="var(--diagram-bg-secondary)" stroke="var(--diagram-border)" stroke-width="1.5"/>
      <text x="300" y="120" text-anchor="middle" font-size="13" font-weight="bold" fill="var(--diagram-text)">100,000 토큰</text>
      <text x="60" y="150" font-size="11" fill="var(--diagram-text)">긴 기술 문서, 학술 논문 50편</text>
      <text x="60" y="170" font-size="11" fill="var(--diagram-text)">약 25만 단어</text>

      <!-- 50K 토큰 윈도우 (작은 박스) -->
      <rect x="50" y="210" width="300" height="60" fill="var(--diagram-bg-tertiary)" stroke="var(--diagram-border)" stroke-width="1.5"/>
      <text x="200" y="200" text-anchor="middle" font-size="13" font-weight="bold" fill="var(--diagram-text)">50,000 토큰</text>
      <text x="60" y="230" font-size="11" fill="var(--diagram-text)">책 1~2권</text>
      <text x="60" y="250" font-size="11" fill="var(--diagram-text)">약 12만 단어</text>

      <!-- 화살표 설명 -->
      <line x1="580" y1="160" x2="680" y2="70" stroke="var(--diagram-arrow)" stroke-width="1.5" marker-end="url(#longctx-1-arrow)"/>
      <text x="690" y="60" font-size="11" fill="var(--diagram-secondary)">더 큰 컨텍스트 =</text>
      <text x="690" y="75" font-size="11" fill="var(--diagram-secondary)">더 많은 정보 보관</text>
    </svg>
    <figcaption style="text-align: center; margin-top: 0.8rem; font-size: 0.95rem; color: var(--text-tertiary);">
      그림 1: 컨텍스트 윈도우 규모 비교 - Claude는 최대 200K 토큰을 동시에 처리 가능
    </figcaption>
  </figure>
</section>

<section class="content-section">
  <h2 id="use-cases">활용 사례</h2>

  <h3 id="document-analysis">대규모 문서 분석</h3>
  <p>
    법률 계약서, 연구 논문, 기술 매뉴얼 등 긴 문서를 통째로 입력하고 질문할 수 있습니다.
  </p>

  <div class="code-block">
    <div class="code-header">
      <span class="code-lang">Python 예시</span>
      <button class="code-copy" aria-label="코드 복사">Copy</button>
    </div>
    <pre><code><span class="kw">from</span> anthropic <span class="kw">import</span> Anthropic

client <span class="kw">=</span> <span class="fn">Anthropic</span>()

<span class="cmt"># 대규모 문서 읽기</span>
<span class="kw">with</span> <span class="fn">open</span>(<span class="str">'legal_contract.txt'</span>, <span class="str">'r'</span>, encoding<span class="kw">=</span><span class="str">'utf-8'</span>) <span class="kw">as</span> f:
    document <span class="kw">=</span> f.<span class="fn">read</span>()

message <span class="kw">=</span> client.messages.<span class="fn">create</span>(
    model<span class="kw">=</span><span class="str">"claude-sonnet-4-5-20250929"</span>,
    max_tokens<span class="kw">=</span><span class="num">2048</span>,
    messages<span class="kw">=</span>[
        {
            <span class="str">"role"</span>: <span class="str">"user"</span>,
            <span class="str">"content"</span>: <span class="fn">f</span><span class="str">"""다음 계약서를 분석하고 핵심 조항을 요약해주세요:

{document}

특히 다음 항목에 집중해주세요:
1. 계약 기간 및 종료 조건
2. 비용 및 지불 조건
3. 책임 및 보증 조항"""</span>
        }
    ]
)

<span class="fn">print</span>(message.content[<span class="num">0</span>].text)</code></pre>
  </div>

  <h3 id="codebase-understanding">코드베이스 이해</h3>
  <p>
    여러 파일의 소스 코드를 한 번에 입력하고, 구조 분석, 버그 찾기, 리팩토링 제안 등을 받을 수 있습니다.
  </p>

  <div class="code-block">
    <div class="code-header">
      <span class="code-lang">Python 코드베이스 분석 예시</span>
      <button class="code-copy" aria-label="코드 복사">Copy</button>
    </div>
    <pre><code><span class="kw">import</span> os
<span class="kw">from</span> pathlib <span class="kw">import</span> Path

<span class="kw">def</span> <span class="fn">gather_codebase</span>(root_dir, extensions<span class="kw">=</span>[<span class="str">'.py'</span>, <span class="str">'.js'</span>, <span class="str">'.ts'</span>]):
    files <span class="kw">=</span> []
    <span class="kw">for</span> ext <span class="kw">in</span> extensions:
        files.<span class="fn">extend</span>(<span class="fn">Path</span>(root_dir).<span class="fn">rglob</span>(<span class="fn">f</span><span class="str">"*{ext}"</span>))

    codebase <span class="kw">=</span> <span class="str">""</span>
    <span class="kw">for</span> file_path <span class="kw">in</span> files:
        <span class="kw">with</span> <span class="fn">open</span>(file_path, <span class="str">'r'</span>, encoding<span class="kw">=</span><span class="str">'utf-8'</span>) <span class="kw">as</span> f:
            content <span class="kw">=</span> f.<span class="fn">read</span>()
            codebase <span class="kw">+=</span> <span class="fn">f</span><span class="str">"\n\n{'='*60}\nFile: {file_path}\n{'='*60}\n{content}"</span>

    <span class="kw">return</span> codebase

<span class="cmt"># 코드베이스 수집</span>
code <span class="kw">=</span> <span class="fn">gather_codebase</span>(<span class="str">'./src'</span>)

message <span class="kw">=</span> client.messages.<span class="fn">create</span>(
    model<span class="kw">=</span><span class="str">"claude-sonnet-4-5-20250929"</span>,
    max_tokens<span class="kw">=</span><span class="num">4096</span>,
    messages<span class="kw">=</span>[
        {
            <span class="str">"role"</span>: <span class="str">"user"</span>,
            <span class="str">"content"</span>: <span class="fn">f</span><span class="str">"""다음 코드베이스를 분석하고:
1. 전체 아키텍처 개요
2. 잠재적 버그나 개선 사항
3. 테스트 커버리지 개선 제안

{code}"""</span>
        }
    ]
)</code></pre>
  </div>

  <h3 id="long-conversation">긴 대화 유지</h3>
  <p>
    수백 번의 대화 턴을 컨텍스트로 유지하며 일관성 있는 대화를 이어갈 수 있습니다.
  </p>
</section>

<section class="content-section">
  <h2 id="best-practices">베스트 프랙티스</h2>

  <h3 id="token-counting">1. 토큰 수 사전 확인</h3>
  <p>
    긴 컨텍스트를 사용하기 전에 토큰 수를 확인하여 비용을 예측하세요.
  </p>

  <div class="code-block">
    <div class="code-header">
      <span class="code-lang">Python 토큰 카운팅</span>
      <button class="code-copy" aria-label="코드 복사">Copy</button>
    </div>
    <pre><code><span class="kw">from</span> anthropic <span class="kw">import</span> Anthropic

client <span class="kw">=</span> <span class="fn">Anthropic</span>()

<span class="cmt"># 토큰 수 계산 (Messages API 형식)</span>
token_count <span class="kw">=</span> client.messages.<span class="fn">count_tokens</span>(
    model<span class="kw">=</span><span class="str">"claude-sonnet-4-5-20250929"</span>,
    messages<span class="kw">=</span>[
        {<span class="str">"role"</span>: <span class="str">"user"</span>, <span class="str">"content"</span>: document}
    ]
)

<span class="fn">print</span>(<span class="fn">f</span><span class="str">"입력 토큰 수: {token_count.input_tokens}"</span>)

<span class="cmt"># 비용 계산 (Sonnet 4.5 기준: $3/MTok input, $15/MTok output)</span>
input_cost <span class="kw">=</span> (token_count.input_tokens <span class="kw">/</span> <span class="num">1_000_000</span>) <span class="kw">*</span> <span class="num">3</span>
<span class="fn">print</span>(<span class="fn">f</span><span class="str">"예상 입력 비용: ${input_cost:.4f}"</span>)</code></pre>
  </div>

  <h3 id="structured-content">2. 구조화된 컨텐츠 제공</h3>
  <p>
    긴 문서를 전달할 때는 명확한 구분자와 레이블을 사용하세요. Claude가 정보를 정확히 참조할 수 있습니다.
  </p>

  <div class="code-block">
    <div class="code-header">
      <span class="code-lang">구조화된 입력 예시</span>
    </div>
    <pre><code>prompt <span class="kw">=</span> <span class="fn">f</span><span class="str">"""다음 문서들을 분석해주세요:

&lt;document name="계약서_A"&gt;
{contract_a}
&lt;/document&gt;

&lt;document name="계약서_B"&gt;
{contract_b}
&lt;/document&gt;

&lt;document name="참조_가이드"&gt;
{reference_guide}
&lt;/document&gt;

위 세 문서를 비교하고, 계약서 A와 B의 차이점을 참조 가이드를 기준으로 분석해주세요."""</span></code></pre>
  </div>

  <h3 id="prompt-caching">3. 프롬프트 캐싱 활용 (Prompt Caching)</h3>
  <p>
    같은 긴 컨텍스트를 반복 사용하는 경우, 프롬프트 캐싱을 사용하면 비용을 90% 절감하고 응답 속도를 높일 수 있습니다.
  </p>

  <div class="code-block">
    <div class="code-header">
      <span class="code-lang">프롬프트 캐싱 예시 (Python)</span>
      <button class="code-copy" aria-label="코드 복사">Copy</button>
    </div>
    <pre><code>message <span class="kw">=</span> client.messages.<span class="fn">create</span>(
    model<span class="kw">=</span><span class="str">"claude-sonnet-4-5-20250929"</span>,
    max_tokens<span class="kw">=</span><span class="num">1024</span>,
    system<span class="kw">=</span>[
        {
            <span class="str">"type"</span>: <span class="str">"text"</span>,
            <span class="str">"text"</span>: <span class="str">"당신은 법률 전문 AI 어시스턴트입니다."</span>
        },
        {
            <span class="str">"type"</span>: <span class="str">"text"</span>,
            <span class="str">"text"</span>: large_legal_document,
            <span class="str">"cache_control"</span>: {<span class="str">"type"</span>: <span class="str">"ephemeral"</span>}  <span class="cmt"># 캐시 활성화</span>
        }
    ],
    messages<span class="kw">=</span>[
        {<span class="str">"role"</span>: <span class="str">"user"</span>, <span class="str">"content"</span>: <span class="str">"제3조의 의미를 설명해주세요."</span>}
    ]
)

<span class="cmt"># 동일한 문서로 다른 질문 (캐시된 컨텍스트 재사용)</span>
message2 <span class="kw">=</span> client.messages.<span class="fn">create</span>(
    model<span class="kw">=</span><span class="str">"claude-sonnet-4-5-20250929"</span>,
    max_tokens<span class="kw">=</span><span class="num">1024</span>,
    system<span class="kw">=</span>[
        {<span class="str">"type"</span>: <span class="str">"text"</span>, <span class="str">"text"</span>: <span class="str">"당신은 법률 전문 AI 어시스턴트입니다."</span>},
        {
            <span class="str">"type"</span>: <span class="str">"text"</span>,
            <span class="str">"text"</span>: large_legal_document,
            <span class="str">"cache_control"</span>: {<span class="str">"type"</span>: <span class="str">"ephemeral"</span>}
        }
    ],
    messages<span class="kw">=</span>[
        {<span class="str">"role"</span>: <span class="str">"user"</span>, <span class="str">"content"</span>: <span class="str">"제5조에 명시된 금액은 얼마인가요?"</span>}
    ]
)  <span class="cmt"># 이 요청은 캐시 덕분에 훨씬 빠르고 저렴함</span></code></pre>
  </div>

  <div class="info-box tip">
    <div class="info-box-title">💡 프롬프트 캐싱 요금</div>
    <p>
      캐시된 토큰은 최초 1회만 정상 요금이 부과되고, 이후 5분 내 재사용 시 90% 할인된 가격이 적용됩니다.
      긴 컨텍스트를 반복 사용하는 경우 필수 기능입니다.
    </p>
  </div>

  <figure style="margin: 2.5rem 0;">
    <svg viewBox="0 0 900 380" style="width: 100%; max-width: 900px; height: auto; display: block; margin: 0 auto;">
      <defs>
        <marker id="longctx-2-arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
          <path d="M0,0 L8,3 L0,6 Z" fill="var(--diagram-arrow)"/>
        </marker>
      </defs>

      <!-- 제목 -->
      <text x="450" y="25" text-anchor="middle" font-size="15" font-weight="bold" fill="var(--diagram-text)">프롬프트 캐싱 동작 방식</text>

      <!-- 첫 번째 요청 (캐시 생성) -->
      <text x="450" y="55" text-anchor="middle" font-size="13" font-weight="bold" fill="var(--diagram-text)">첫 번째 요청 (캐시 생성)</text>

      <!-- 대규모 문서 -->
      <rect x="50" y="70" width="200" height="80" fill="var(--diagram-bg-secondary)" stroke="var(--diagram-border)" stroke-width="2" rx="4"/>
      <text x="150" y="95" text-anchor="middle" font-size="12" font-weight="bold" fill="var(--diagram-text)">대규모 법률 문서</text>
      <text x="150" y="115" text-anchor="middle" font-size="10" fill="var(--diagram-secondary)">100,000 토큰</text>
      <text x="150" y="130" text-anchor="middle" font-size="10" fill="var(--diagram-secondary)">(cache_control 설정)</text>

      <!-- 화살표 1 -->
      <line x1="250" y1="110" x2="330" y2="110" stroke="var(--diagram-arrow)" stroke-width="2" marker-end="url(#longctx-2-arrow)"/>
      <text x="290" y="100" text-anchor="middle" font-size="10" fill="var(--diagram-secondary)">전송</text>

      <!-- Claude API -->
      <rect x="330" y="80" width="140" height="60" fill="var(--diagram-primary)" stroke="var(--diagram-border)" stroke-width="2" rx="4"/>
      <text x="400" y="105" text-anchor="middle" font-size="12" font-weight="bold" fill="var(--diagram-text)">Claude API</text>
      <text x="400" y="125" text-anchor="middle" font-size="10" fill="var(--diagram-text)">처리 + 캐싱</text>

      <!-- 화살표 2 -->
      <line x1="470" y1="110" x2="550" y2="110" stroke="var(--diagram-arrow)" stroke-width="2" marker-end="url(#longctx-2-arrow)"/>

      <!-- 캐시 저장소 -->
      <rect x="550" y="70" width="150" height="80" fill="var(--diagram-cache)" stroke="var(--diagram-border)" stroke-width="2" rx="4"/>
      <text x="625" y="95" text-anchor="middle" font-size="12" font-weight="bold" fill="var(--diagram-text)">캐시 저장소</text>
      <text x="625" y="115" text-anchor="middle" font-size="10" fill="var(--diagram-secondary)">100K 토큰 저장</text>
      <text x="625" y="135" text-anchor="middle" font-size="10" fill="var(--diagram-success)">5분간 유효</text>

      <!-- 비용 표시 -->
      <rect x="740" y="85" width="120" height="50" fill="var(--diagram-bg-tertiary)" stroke="var(--diagram-warning)" stroke-width="2" rx="4"/>
      <text x="800" y="108" text-anchor="middle" font-size="11" font-weight="bold" fill="var(--diagram-text)">비용: $0.30</text>
      <text x="800" y="125" text-anchor="middle" font-size="9" fill="var(--diagram-secondary)">(정상 요금)</text>

      <!-- 구분선 -->
      <line x1="50" y1="180" x2="850" y2="180" stroke="var(--diagram-border)" stroke-width="1" stroke-dasharray="5,5"/>

      <!-- 두 번째 요청 (캐시 재사용) -->
      <text x="450" y="210" text-anchor="middle" font-size="13" font-weight="bold" fill="var(--diagram-text)">두 번째 요청 (5분 내 재사용)</text>

      <!-- 다른 질문 -->
      <rect x="50" y="225" width="200" height="80" fill="var(--diagram-bg-secondary)" stroke="var(--diagram-border)" stroke-width="2" rx="4"/>
      <text x="150" y="250" text-anchor="middle" font-size="12" font-weight="bold" fill="var(--diagram-text)">같은 문서</text>
      <text x="150" y="270" text-anchor="middle" font-size="10" fill="var(--diagram-secondary)">+ 다른 질문</text>
      <text x="150" y="290" text-anchor="middle" font-size="10" fill="var(--diagram-secondary)">(cache_control 동일)</text>

      <!-- 화살표 3 -->
      <line x1="250" y1="265" x2="330" y2="265" stroke="var(--diagram-arrow)" stroke-width="2" marker-end="url(#longctx-2-arrow)"/>

      <!-- Claude API -->
      <rect x="330" y="235" width="140" height="60" fill="var(--diagram-primary)" stroke="var(--diagram-border)" stroke-width="2" rx="4"/>
      <text x="400" y="260" text-anchor="middle" font-size="12" font-weight="bold" fill="var(--diagram-text)">Claude API</text>
      <text x="400" y="280" text-anchor="middle" font-size="10" fill="var(--diagram-text)">캐시 확인</text>

      <!-- 화살표 4 (캐시에서 가져오기) -->
      <line x1="550" y1="245" x2="470" y2="245" stroke="var(--diagram-success)" stroke-width="2" marker-end="url(#longctx-2-arrow)"/>
      <text x="510" y="238" text-anchor="middle" font-size="10" fill="var(--diagram-success)" font-weight="bold">캐시 HIT!</text>

      <!-- 캐시 저장소 (재사용) -->
      <rect x="550" y="225" width="150" height="80" fill="var(--diagram-cache)" stroke="var(--diagram-success)" stroke-width="3" rx="4"/>
      <text x="625" y="250" text-anchor="middle" font-size="12" font-weight="bold" fill="var(--diagram-text)">캐시 저장소</text>
      <text x="625" y="270" text-anchor="middle" font-size="10" fill="var(--diagram-success)">즉시 재사용</text>
      <text x="625" y="290" text-anchor="middle" font-size="10" fill="var(--diagram-secondary)">재전송 불필요</text>

      <!-- 비용 표시 (할인) -->
      <rect x="740" y="240" width="120" height="50" fill="var(--diagram-bg-tertiary)" stroke="var(--diagram-success)" stroke-width="2" rx="4"/>
      <text x="800" y="263" text-anchor="middle" font-size="11" font-weight="bold" fill="var(--diagram-success)">비용: $0.03</text>
      <text x="800" y="280" text-anchor="middle" font-size="9" fill="var(--diagram-secondary)">(90% 할인!)</text>

      <!-- 하단 요약 박스 -->
      <rect x="50" y="330" width="260" height="40" fill="var(--diagram-bg-tertiary)" stroke="var(--diagram-border)" stroke-width="1.5" rx="4"/>
      <text x="180" y="347" text-anchor="middle" font-size="11" font-weight="bold" fill="var(--diagram-text)">💰 비용 절감</text>
      <text x="180" y="362" text-anchor="middle" font-size="10" fill="var(--diagram-secondary)">$0.30 → $0.03 (90% 절감)</text>

      <rect x="330" y="330" width="260" height="40" fill="var(--diagram-bg-tertiary)" stroke="var(--diagram-border)" stroke-width="1.5" rx="4"/>
      <text x="460" y="347" text-anchor="middle" font-size="11" font-weight="bold" fill="var(--diagram-text)">⚡ 속도 향상</text>
      <text x="460" y="362" text-anchor="middle" font-size="10" fill="var(--diagram-secondary)">대용량 문서 재전송 불필요</text>

      <rect x="610" y="330" width="240" height="40" fill="var(--diagram-bg-tertiary)" stroke="var(--diagram-border)" stroke-width="1.5" rx="4"/>
      <text x="730" y="347" text-anchor="middle" font-size="11" font-weight="bold" fill="var(--diagram-text)">⏱️ 캐시 유효 시간</text>
      <text x="730" y="362" text-anchor="middle" font-size="10" fill="var(--diagram-secondary)">5분 (이후 자동 만료)</text>
    </svg>
    <figcaption style="text-align: center; margin-top: 0.8rem; font-size: 0.95rem; color: var(--text-tertiary);">
      그림 2: 프롬프트 캐싱 동작 방식 - 같은 문서를 5분 내 재사용 시 90% 비용 절감 및 응답 속도 향상
    </figcaption>
  </figure>

  <h3 id="chunking">4. 필요 시 청킹 (Chunking) 전략</h3>
  <p>
    200K 토큰을 초과하거나, 처리 시간을 단축하고 싶다면 문서를 청크로 나눠 처리하세요.
  </p>

  <div class="code-block">
    <div class="code-header">
      <span class="code-lang">청킹 전략 예시</span>
      <button class="code-copy" aria-label="코드 복사">Copy</button>
    </div>
    <pre><code><span class="kw">def</span> <span class="fn">process_large_doc_in_chunks</span>(document, chunk_size<span class="kw">=</span><span class="num">50000</span>):
    chunks <span class="kw">=</span> [document[i:i<span class="kw">+</span>chunk_size] <span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span class="num">0</span>, <span class="fn">len</span>(document), chunk_size)]
    summaries <span class="kw">=</span> []

    <span class="kw">for</span> idx, chunk <span class="kw">in</span> <span class="fn">enumerate</span>(chunks):
        message <span class="kw">=</span> client.messages.<span class="fn">create</span>(
            model<span class="kw">=</span><span class="str">"claude-sonnet-4-5-20250929"</span>,
            max_tokens<span class="kw">=</span><span class="num">2048</span>,
            messages<span class="kw">=</span>[
                {
                    <span class="str">"role"</span>: <span class="str">"user"</span>,
                    <span class="str">"content"</span>: <span class="fn">f</span><span class="str">"다음은 문서의 {idx+1}번째 부분입니다. 핵심 내용을 요약해주세요:\n\n{chunk}"</span>
                }
            ]
        )
        summaries.<span class="fn">append</span>(message.content[<span class="num">0</span>].text)

    <span class="cmt"># 최종 통합 요약</span>
    final <span class="kw">=</span> client.messages.<span class="fn">create</span>(
        model<span class="kw">=</span><span class="str">"claude-sonnet-4-5-20250929"</span>,
        max_tokens<span class="kw">=</span><span class="num">4096</span>,
        messages<span class="kw">=</span>[
            {
                <span class="str">"role"</span>: <span class="str">"user"</span>,
                <span class="str">"content"</span>: <span class="fn">f</span><span class="str">"다음 요약들을 통합하여 최종 요약을 작성해주세요:\n\n{''.join(summaries)}"</span>
            }
        ]
    )

    <span class="kw">return</span> final.content[<span class="num">0</span>].text</code></pre>
  </div>
</section>

<section class="content-section">
  <h2 id="limitations">제한사항 및 고려사항</h2>

  <h3 id="cost">비용</h3>
  <p>
    긴 컨텍스트는 강력하지만 비용이 높습니다. 입력 토큰이 많을수록 요금이 증가하므로, 실제로 필요한 정보만 포함시키세요.
  </p>

  <table>
    <thead>
      <tr>
        <th>모델</th>
        <th>입력 토큰 가격 (MTok)</th>
        <th>100K 토큰 비용</th>
        <th>200K 토큰 비용</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Claude Opus 4.6</td>
        <td>$15</td>
        <td>$1.50</td>
        <td>$3.00</td>
      </tr>
      <tr>
        <td>Claude Sonnet 4.5</td>
        <td>$3</td>
        <td>$0.30</td>
        <td>$0.60</td>
      </tr>
      <tr>
        <td>Claude Haiku 4.5</td>
        <td>$0.80</td>
        <td>$0.08</td>
        <td>$0.16</td>
      </tr>
    </tbody>
  </table>

  <h3 id="latency">지연 시간</h3>
  <p>
    컨텍스트가 길수록 응답 생성 시작까지 시간이 더 걸립니다. 실시간 대화에는 적합하지 않을 수 있습니다.
  </p>

  <h3 id="needle-in-haystack">정보 검색 정확도</h3>
  <p>
    Claude는 긴 컨텍스트에서도 높은 정확도로 정보를 검색하지만 ("Needle in a Haystack" 테스트 통과),
    명확한 구조화와 레이블링을 통해 정확도를 더욱 높일 수 있습니다.
  </p>
</section>

<section class="content-section">
  <h2 id="advanced-techniques">고급 기법</h2>

  <h3 id="rag-vs-long-context">RAG vs 긴 컨텍스트</h3>
  <p>
    Retrieval-Augmented Generation(RAG)과 긴 컨텍스트는 상호 보완적입니다:
  </p>

  <table>
    <thead>
      <tr>
        <th>비교 항목</th>
        <th>긴 컨텍스트</th>
        <th>RAG</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>데이터 규모</td>
        <td>~200K 토큰</td>
        <td>무제한 (벡터 DB)</td>
      </tr>
      <tr>
        <td>정확도</td>
        <td>매우 높음 (전체 맥락)</td>
        <td>검색 품질에 의존</td>
      </tr>
      <tr>
        <td>비용</td>
        <td>입력 토큰당 과금</td>
        <td>검색된 토큰만 과금</td>
      </tr>
      <tr>
        <td>복잡도</td>
        <td>낮음 (직접 입력)</td>
        <td>높음 (임베딩, 검색)</td>
      </tr>
      <tr>
        <td>적합한 경우</td>
        <td>전체 맥락 필요, 소규모 데이터</td>
        <td>대규모 데이터, 부분 검색</td>
      </tr>
    </tbody>
  </table>

  <p><strong>추천:</strong> 200K 토큰 이내면 긴 컨텍스트, 그 이상이면 RAG + 긴 컨텍스트 조합</p>

  <div class="info-box tip" style="margin-top: 2rem;">
    <div class="info-box-title">🎯 언제 전체 컨텍스트를 사용해야 하나요?</div>
    <p><strong>✅ 긴 컨텍스트 권장:</strong></p>
    <ul>
      <li><strong>전체 맥락 필요</strong>: 문서 전체의 흐름과 일관성 파악 (법률 계약서, 소설 분석)</li>
      <li><strong>소규모 데이터</strong>: 100-200K 토큰 이내 (책 3권 이하)</li>
      <li><strong>빠른 프로토타이핑</strong>: RAG 구축 시간 없이 즉시 시작</li>
      <li><strong>구조가 복잡한 문서</strong>: 표, 코드, 수식이 섞인 기술 문서</li>
      <li><strong>일회성 분석</strong>: 단발성 작업 (캐싱 미사용)</li>
    </ul>
    <p style="margin-top: 1em;"><strong>❌ RAG 권장:</strong></p>
    <ul>
      <li><strong>대규모 지식 베이스</strong>: 수백 개 문서, 수천만 토큰</li>
      <li><strong>부분 검색</strong>: 특정 키워드/주제만 찾는 경우</li>
      <li><strong>실시간 업데이트</strong>: 문서가 자주 변경되는 경우</li>
      <li><strong>비용 최적화</strong>: 매번 전체 컨텍스트 비용 부담 (반복 사용 시 캐싱 고려)</li>
    </ul>
    <p style="margin-top: 1em;">
      💡 <strong>하이브리드 전략</strong>: RAG로 관련 문서 검색 → 검색된 문서들을 긴 컨텍스트로 통합 분석 (최고 정확도!)
    </p>
  </div>
</section>

<section class="content-section">
  <h2 id="next-steps">다음 단계</h2>
  <p>긴 컨텍스트 활용법을 익혔다면 다음 주제들도 살펴보세요:</p>

  <ul>
    <li><a href="system-prompts.html">시스템 프롬프트</a> - 긴 컨텍스트 분석을 위한 역할 정의</li>
    <li><a href="prompt-patterns.html">프롬프트 패턴</a> - 대규모 문서 처리 패턴</li>
    <li><a href="document-analysis.html">문서 분석</a> - 실전 문서 분석 예시</li>
    <li><a href="pricing.html">요금</a> - 토큰 사용량 최적화 전략</li>
  </ul>
</section>

<nav class="page-nav"></nav>

</main>

<aside class="inline-toc"></aside>
<footer class="site-footer"></footer>

</div>
<script src="../js/main.js"></script>
</body>
</html>
